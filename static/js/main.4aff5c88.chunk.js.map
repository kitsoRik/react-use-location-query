{"version":3,"sources":["../../src/values-controller.ts","../../node_modules/querystring/decode.js","../../node_modules/querystring/encode.js","../../node_modules/querystring/index.js","../../src/query-parser.ts","../../src/location-controller.ts","../../src/index.ts","App.tsx","index.tsx"],"names":["defaultValues","normalizeValues","values","normalized","Object","key","value","normalizeValuesForUser","defaultValue","parseInt","compareValues","Error","obj","prop","prototype","hasOwnProperty","call","qs","sep","eq","options","length","regexp","split","maxKeys","len","i","kstr","vstr","k","v","x","replace","idx","indexOf","substr","decodeURIComponent","Array","isArray","push","stringifyPrimitive","isFinite","name","undefined","keys","map","ks","encodeURIComponent","join","exports","parse","require$$0","stringify","require$$1","parseQuery","query","writeQuery","history","location","pathname","stringifyQuery","calculateLocationPath","queryValues","storedValue","getDefaultValues","joinValues","result","locationQuery","normalizeValue","prepareValuesForLocation","useLocationQuery","useHistory","useLocation","useEffect","index","removeDefaultValues","fullQuery","readQuery","extractQueryByDefaultValues","setQueryField","field","FirstComponent","surname","type","default","hideIfDefault","SecondComponent","lastname","console","log","App","age","visible","tab","onClick","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4aff5c88.chunk.js","sourcesContent":["import { DefaultValueField, DefaultValues } from './types';\r\n\r\nlet defaultValues: DefaultValues[] = [];\r\n\r\nexport const normalizeValues = (values: object) => {\r\n\tconst normalized: any = { ...values };\r\n\tObject.keys(normalized).forEach((key) => {\r\n\t\tconst value = normalized[key];\r\n\t\tif (typeof value === 'object') {\r\n\t\t\tswitch (value.type) {\r\n\t\t\t\tcase 'boolean':\r\n\t\t\t\t\tswitch (value.type) {\r\n\t\t\t\t\t\tcase 'boolean':\r\n\t\t\t\t\t\t\tnormalized[key] = value.default;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\tnormalized[key] = value.default === 'true';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'string':\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tnormalized[key] = value.default;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\treturn normalized;\r\n};\r\n\r\nconst normalizeValue = (value: DefaultValueField) => {\r\n\treturn typeof value === 'object' ? value.default : value;\r\n};\r\n\r\nexport const prepareValuesForLocation = (\r\n\tvalues: object,\r\n\tdefaultValues: DefaultValues\r\n) => {\r\n\tconst normalized: any = { ...values };\r\n\tObject.keys(normalized).forEach((key) => {\r\n\t\tconst value = normalized[key];\r\n\t\tconst defaultValue = defaultValues[key];\r\n\t\tif (typeof defaultValue === 'object') {\r\n\t\t\t// if (!checkValue(value, defaultValue)) {\r\n\t\t\t// \tif (defaultValue.onPassedUncorrectValue) {\r\n\t\t\t// \t\tvalue = defaultValue.onPassedUncorrectValue(value);\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\tif (defaultValue.hideIfDefault) {\r\n\t\t\t\tif (compareValues(value, defaultValue)) {\r\n\t\t\t\t\tdelete normalized[key];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tnormalized[key] = normalizeValue(value);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\treturn normalized;\r\n};\r\n\r\nexport const normalizeValuesForUser = (values: any, defaultValues: any) => {\r\n\tconst normalized = { ...values };\r\n\tObject.keys(normalized).forEach((key) => {\r\n\t\tconst value = normalized[key];\r\n\t\tconst defaultValue = defaultValues[key];\r\n\t\tif (typeof defaultValue === 'object') {\r\n\t\t\tswitch (defaultValue.type) {\r\n\t\t\t\tcase 'boolean':\r\n\t\t\t\t\tnormalized[key] = value === 'true';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tnormalized[key] = parseInt(value);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tswitch (typeof defaultValue) {\r\n\t\t\t\tcase 'boolean':\r\n\t\t\t\t\tnormalized[key] = value === 'true';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tnormalized[key] = parseInt(value);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\treturn normalized;\r\n};\r\n\r\nexport const getDefaultValues = () => {\r\n\tlet normalized = {};\r\n\tdefaultValues.forEach((storedValue) => {\r\n\t\tnormalized = { ...normalized, ...storedValue };\r\n\t});\r\n\r\n\treturn normalized;\r\n};\r\n\r\nexport const getNormalizedStoredValues = () => {\r\n\tlet normalized = {};\r\n\tdefaultValues.forEach((storedValue) => {\r\n\t\tnormalized = { ...normalized, ...storedValue };\r\n\t});\r\n\r\n\tnormalized = normalizeValues(normalized);\r\n\r\n\treturn normalized;\r\n};\r\n\r\nexport const appendDefaultValues = (values: DefaultValues) => {\r\n\tdefaultValues = [...defaultValues, values];\r\n\treturn defaultValues.length - 1;\r\n};\r\n\r\nexport const removeDefaultValues = (index: number) => {\r\n\tdefaultValues.splice(index, 1);\r\n};\r\n\r\nexport const checkValue = (\r\n\tvalue: DefaultValueField | string,\r\n\tdefaultValue: DefaultValueField\r\n) => {\r\n\tif (typeof value === 'object') return true;\r\n\tswitch (typeof defaultValue) {\r\n\t\tcase 'boolean':\r\n\t\t\treturn value === 'true' || value === 'false';\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nexport const compareValues = (value: any, defaultValue: any) => {\r\n\tif (typeof defaultValue === 'object') {\r\n\t\tif (typeof value === 'object') {\r\n\t\t\treturn value.default === defaultValue.default;\r\n\t\t} else {\r\n\t\t\tswitch (defaultValue.type) {\r\n\t\t\t\tcase 'boolean':\r\n\t\t\t\t\tswitch (typeof value) {\r\n\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\treturn defaultValue.default === (value === 'true');\r\n\t\t\t\t\t\tcase 'boolean':\r\n\t\t\t\t\t\t\treturn defaultValue.default === value;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t`Bad compare with type boolean, actually (${typeof value})`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tswitch (typeof value) {\r\n\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\tdefaultValue.default ===\r\n\t\t\t\t\t\t\t\tparseInt(value as string)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\treturn defaultValue.default === value;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t`Bad compare with type number, actually (${typeof value}`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn value === defaultValue.default;\r\n\t\t}\r\n\t} else {\r\n\t\treturn value === defaultValue;\r\n\t}\r\n};\r\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (Array.isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return Object.keys(obj).map(function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (Array.isArray(obj[k])) {\n        return obj[k].map(function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","import qs from 'querystring';\r\nimport { normalizeValues } from './values-controller';\r\nimport { DefaultValues, Location, History } from './types';\r\n\r\nexport const extractQueryByDefaultValues = (\r\n\tquery: any,\r\n\tdefaultValues: DefaultValues\r\n) => {\r\n\tconst result: any = {};\r\n\tObject.keys(defaultValues).forEach((key) => {\r\n\t\tresult[key] = query[key] ? query[key] : defaultValues[key];\r\n\t});\r\n\r\n\treturn result;\r\n};\r\n\r\nexport const parseQuery = (query: string) => {\r\n\treturn qs.parse(query === '' ? '' : query.substring(1));\r\n};\r\n\r\nexport const stringifyQuery = (query: object) => {\r\n\treturn qs.stringify({ ...normalizeValues(query) });\r\n};\r\n\r\nexport const readQuery = (location: Location, defaultValues: DefaultValues) => {\r\n\treturn { ...defaultValues, ...parseQuery(location.search) };\r\n};\r\n\r\nexport const writeQuery = (\r\n\tlocation: Location,\r\n\thistory: History,\r\n\tquery: object\r\n) => {\r\n\tif (Object.keys(query).length === 0) {\r\n\t\thistory.replace(location.pathname);\r\n\t} else {\r\n\t\thistory.replace(\r\n\t\t\t`${location.pathname}?${stringifyQuery(normalizeValues(query))}`\r\n\t\t);\r\n\t}\r\n};\r\n","import {\r\n\tgetDefaultValues,\r\n\tprepareValuesForLocation\r\n} from './values-controller';\r\nimport { parseQuery, writeQuery } from './query-parser';\r\nimport { Location, History, DefaultValues } from './types';\r\n\r\nexport const calculateLocationPath = (location: Location, history: History) => {\r\n\tconst queryValues = parseQuery(location.search);\r\n\tconst defaultValues = getDefaultValues();\r\n\r\n\twriteQuery(location, history, joinValues(defaultValues, queryValues));\r\n};\r\n\r\nexport const setQueryField = (\r\n\tlocation: Location,\r\n\thistory: History,\r\n\tfield: string,\r\n\tvalue: any\r\n) => {\r\n\tconst values = { ...parseQuery(location.search) };\r\n\tvalues[field] = value;\r\n\twriteQuery(location, history, values);\r\n};\r\n\r\nconst joinValues = (defaultValues: DefaultValues, locationQuery: any) => {\r\n\tconst result = { ...defaultValues };\r\n\tObject.keys(locationQuery).forEach((key) => {\r\n\t\tconst value = result[key];\r\n\t\tif (value) {\r\n\t\t\tresult[key] = locationQuery[key];\r\n\t\t}\r\n\t});\r\n\r\n\treturn prepareValuesForLocation(result, defaultValues);\r\n};\r\n","import { useHistory, useLocation } from 'react-router-dom';\r\nimport { useEffect } from 'react';\r\nimport {\r\n\tappendDefaultValues,\r\n\tremoveDefaultValues,\r\n\tnormalizeValues,\r\n\tnormalizeValuesForUser\r\n} from './values-controller';\r\nimport { calculateLocationPath, setQueryField } from './location-controller';\r\nimport { extractQueryByDefaultValues, readQuery } from './query-parser';\r\nimport { DefaultValues } from './types';\r\n\r\nexport const useLocationQuery = (defaultValues: DefaultValues) => {\r\n\tconst history = useHistory();\r\n\tconst location = useLocation();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst index = appendDefaultValues(defaultValues);\r\n\t\tcalculateLocationPath(location, history);\r\n\t\treturn () => {\r\n\t\t\tremoveDefaultValues(index);\r\n\t\t\tcalculateLocationPath(location, history);\r\n\t\t};\r\n\t}, []);\r\n\r\n\tconst fullQuery = readQuery(location, normalizeValues(defaultValues));\r\n\tconst query = extractQueryByDefaultValues(\r\n\t\tfullQuery,\r\n\t\tnormalizeValues(defaultValues)\r\n\t);\r\n\r\n\treturn {\r\n\t\tfullQuery,\r\n\t\tquery: normalizeValuesForUser(query, defaultValues) as any,\r\n\t\tsetQueryField: (field: string, value: any) =>\r\n\t\t\tsetQueryField(location, history, field, value)\r\n\t};\r\n};\r\n","import React from 'react';\nimport { useLocationQuery } from 'react-use-location-query';\nimport { useLocation } from 'react-router-dom';\n\nconst App = () => {\n\tconst { query, setQueryField } = useLocationQuery({\n\t\tname: {\n\t\t\ttype: 'string',\n\t\t\tdefault: 'qwee',\n\t\t\thideIfDefault: true\n\t\t},\n\t\tage: {\n\t\t\ttype: 'number',\n\t\t\tdefault: 19,\n\t\t\thideIfDefault: true\n\t\t},\n\t\tvisible: {\n\t\t\ttype: 'boolean',\n\t\t\tdefault: false,\n\t\t\thideIfDefault: true\n\t\t},\n\t\ttab: 'first'\n\t});\n\tuseLocation();\n\treturn (\n\t\t<div>\n\t\t\t{query.tab === 'first' && <FirstComponent />}\n\t\t\t{query.tab === 'second' && <SecondComponent />}\n\t\t\t<button\n\t\t\t\tonClick={() =>\n\t\t\t\t\tsetQueryField(\n\t\t\t\t\t\t'tab',\n\t\t\t\t\t\tquery.tab === 'first' ? 'second' : 'first'\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t>\n\t\t\t\tClick\n\t\t\t</button>\n\t\t</div>\n\t);\n};\n\nconst FirstComponent = () => {\n\tconst { query } = useLocationQuery({\n\t\tsurname: {\n\t\t\ttype: 'string',\n\t\t\tdefault: 'sur',\n\t\t\thideIfDefault: true\n\t\t}\n\t});\n\treturn (\n\t\t<div>\n\t\t\t<div>Surname: {query.surname}</div>\n\t\t</div>\n\t);\n};\n\nconst SecondComponent = () => {\n\tconst { query, fullQuery } = useLocationQuery({\n\t\tlastname: {\n\t\t\ttype: 'string',\n\t\t\tdefault: 'last'\n\t\t}\n\t});\n\tconsole.log(fullQuery);\n\treturn (\n\t\t<div>\n\t\t\t<div>Lastname: {query.lastname}</div>\n\t\t</div>\n\t);\n};\nexport default App;\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}